/*!
 * Start Bootstrap - SB Admin 2 v4.0.6 ()
 * Copyright 2013-2019 
 * Licensed under  (https://github.com/BlackrockDigital/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

$(document).ready(function(){({init:function(){this.activeTasks=[],this.taskLists=[],this.startGetResults,this.initEvents(),this.getBranches()},initEvents:function(){$("#select_brand").on("change",$.proxy(this.getProfiles,this)),$("#profiles_list").on("change",$.proxy(this.getTaskLists,this)),$("#run_submit").on("click",$.proxy(this.submitTasks,this)),$("#stop_submit").on("click",$.proxy(this.stopTasks,this)),$("#reset_all").on("click",$.proxy(this.resetAll,this)),$("#update_submit").on("click",$.proxy(this.updateRate,this)),$("#task_lists").multiselect({allSelectedText:"All",maxHeight:200,includeSelectAllOption:!0}).multiselect("updateButtonText"),$("#active_task_lists").multiselect({allSelectedText:"All",maxHeight:200,includeSelectAllOption:!0}).multiselect("updateButtonText")},updateDropDowns:function(e,t,s){var a=[];if("multi"===s){for(var i=0;i<t.length;i++)obj=JSON.parse('{"label": "'+t[i]+'", "title": "'+t[i]+'", "value": "'+t[i]+'"}'),a.push(obj);console.log(a),$("#"+e).multiselect("dataprovider",a),$("#"+e).multiselect("rebuild")}else $("#"+e).append("<option value=> Select </option>"),$.map(t,function(t){return $("#"+e).append("<option value="+t+">"+t+"</option>")})},getBranches:function(){$.ajax({url:"http://localhost:8080/api/v1/hudor/getbranches",dataType:"json",method:"GET",success:$.proxy(function(t){this.updateDropDowns("select_brand",t,"single"),$("#select_brand").parent().removeClass("d-none")},this)})},getProfiles:function(t){var e=$(t.currentTarget),s=e.val();e.attr("disabled","disabled"),$.ajax({url:"http://localhost:8080/api/v1/hudor/getprofiles",dataType:"json",method:"GET",data:{selectedBranch:s},success:$.proxy(function(t){this.updateDropDowns("profiles_list",t,"single"),$("#profiles_list").parent().removeClass("d-none")},this)})},getTaskLists:function(t){var e=$(t.currentTarget),s=e.val();e.attr("disabled","disabled"),$.ajax({url:"http://localhost:8080/api/v1/hudor/getalltasks/"+s,dataType:"json",method:"GET",success:$.proxy(function(t){$("#task_lists, #run_submit").parents("li").removeClass("d-none"),this.updateDropDowns("task_lists",t,"multi")},this)})},submitTasks:function(t){for(var e=$("#task_lists").val(),s=this,a="",i=0;i<e.length;i++)a=a+e[i]+",";a=a.slice(0,-1),$.ajax({url:"http://localhost:8080/api/v1/hudor/runtask/"+a,dataType:"json",method:"GET",success:$.proxy(function(t){$("#active_task_lists, #stop_submit").parents("li").removeClass("d-none"),this.updateDropDowns("active_task_lists",e,"multi"),s.getTasksResults(t),this.startGetResults=setInterval(function(){s.getTasksResults(t)},1e4)},this)})},stopTasks:function(t){$(t.currentTarget).attr("disabled","disabled");for(var e=$("#active_task_lists").val(),s="",a=0;a<e.length;a++)s=s+e[a]+",";s=s.slice(0,-1),$.ajax({url:"http://localhost:8080/api/v1/hudor/stopTask/"+s,dataType:"json",method:"GET",success:$.proxy(function(t){"200"===t?$("#stop_notify .alert-info").removeClass("d-none"):$("#stop_notify .alert-danger").removeClass("d-none"),setTimeout(function(){$("#stop_notify .alert").addClass("d-none")},5e3)},this)})},updateRate:function(){var t=$("#active_task").val(),e=$("#rate_value").val();$.ajax({url:"http://localhost:8080/api/v1/hudor/updateTaskRate/"+t+"/"+e,dataType:"json",method:"GET",success:$.proxy(function(t){"200"===t?$("#notify .alert-info").removeClass("d-none"):$("#notify .alert-danger").removeClass("d-none"),setTimeout(function(){$("#notify .alert").addClass("d-none")},5e3)},this)})},getTasksResults:function(t){$.ajax({url:"http://localhost:8080/api/v1/hudor/getActiveTasks",dataType:"json",method:"GET",success:$.proxy(function(t){0<t.length?($("#active_task").parents("li").removeClass("d-none"),this.paintResults(t),this.updateDropDowns("active_task",t,"single"),$("#update_block").removeClass("d-none")):clearInterval(this.startGetResults)},this)})},paintResults:function(t){t={};var e=this,s=$("#results_card");s.empty(),t.data=[{title:"title1",success:"3404",latency:"5443",error:"4343"},{title:"title2",success:"404",latency:"232",error:"45443"},{title:"title3",success:"7604",latency:"657",error:"433"},{title:"title4",success:"37604",latency:"324",error:"466643"},{title:"title5",success:"37604",latency:"775",error:"466643"}],setTimeout($.proxy(function(){t.data.forEach(function(t){s.append(e.getMarkUp(t))})},this),500),$("#empty_search").addClass("d-none"),s.removeClass("d-none")},getSelectedArray:function(){},getMarkUp:function(t){return'<div class="col-md-6 col-xl-3 mb-4"><div class="border-left-primary card h-100 py-2 shadow"><div class=card-body><div class="align-items-center no-gutters row"><div class="col mr-2 text-center"><div class="font-weight-bold h5 mb-1 text-primary text-sm text-uppercase">'+t.title+'</div><br></div></div><div class="align-items-center no-gutters row"><div class="col mr-2 text-center"><div class="font-weight-bold mb-1 text-sm text-uppercase text-success">Success</div><div class="font-weight-bold h5 mb-0 text-gray-800">'+t.success+'</div></div><div class="col mr-2 text-center"><div class="font-weight-bold mb-1 text-sm text-uppercase text-warning">Latency</div><div class="font-weight-bold h5 mb-0 text-gray-800">'+t.latency+'</div></div><div class="col mr-2 text-center"><div class="font-weight-bold mb-1 text-sm text-uppercase text-danger">Failed</div><div class="font-weight-bold h5 mb-0 text-gray-800">'+t.error+"</div></div></div></div></div></div>"},resetAll:function(){clearInterval(this.startGetResults),location.reload("forcedReload")}}).init()});